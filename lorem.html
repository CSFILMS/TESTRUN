<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Unscramble + Images</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --fg:#D4D4D4; --bg:#000; --accent:#00FF00; --soft:#66FF66; }
    html, body { height:100%; }
    
    /* CRT scanline effect */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: repeating-linear-gradient(
        0deg,
        transparent 0px,
        transparent 2px,
        rgba(0, 255, 0, 0.03) 2px,
        rgba(0, 255, 0, 0.03) 4px
      );
      pointer-events: none;
      z-index: 99998;
    }
    
    /* Black scanlines on top */
    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.20) 0px,
        rgba(0, 0, 0, 0.20) 2px,
        transparent 2px,
        transparent 4px
      );
      pointer-events: none;
      z-index: 99999;
    }
    body {
      background:var(--bg); color:var(--fg); font-family:monospace;
      padding:5vw; max-width:80vw; margin:8vh auto; line-height:1.6; user-select:none;
      font-size: 1rem;
      min-height: 100vh;
      box-sizing: border-box;
    }
    
    @media (max-width: 768px) {
      body {
        padding: 4vw;
        margin: 3vh auto;
        font-size: 1rem;
      }
      #page {
        padding: 2vw;
      }
      #unscramble {
        font-size: 1.2rem;
        line-height: 1.6;
      }
      #nav {
        font-size: 2rem;
        margin: 2vh 0 1vh;
      }
      #nav-msg {
        font-size: 1rem;
      }
      #hud {
        font-size: 1rem;
        flex-direction: column;
        gap: 0.5rem;
      }
      #page-counter {
        bottom: 1vh;
        right: 2vw;
      }
    }
    
    @media screen and (min-resolution: 1dppx) {
      body {
        font-size: 1.2rem;
      }
    }
    #page {
      position:relative; 
      height: 60vh;
      min-height: 20em; 
      padding:2rem; 
      border-radius:10px;
      background-size:cover; 
      background-position:center; 
      background-repeat:no-repeat;
      overflow: visible; /* Allow text to be visible */
    }
    
    /* Simple image display */
    #page img {
      display: none;
      filter: brightness(0.7) sepia(1) hue-rotate(60deg) saturate(1.5); /* Default: full green overlay */
      /* Ensure all image formats including GIFs display properly */
      image-rendering: auto;
    }
    
    #page img.show-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
      display: block;
    }
    
    #page img.show-below {
      display: block;
      margin-top: 1rem;
      max-height: 40%;
      max-width: 100%;
      object-fit: contain;
    }
    
    #page img.show-side {
      display: block;
      position: absolute;
      right: 1rem;
      top: 2rem;
      max-width: 35%;
      max-height: 80%;
      object-fit: contain;
      z-index: 1;
    }
    
    /* Text container width is now controlled by JavaScript */
    
    /* Hide the default cursor */
    body {
      cursor: none;
    }
    
    /* Custom cursor element */
    #custom-cursor {
      position: fixed;
      width: 10px;
      height: 10px;
      background: var(--accent);
      border-radius: 50%;
      pointer-events: none;
      z-index: 10000;
      mix-blend-mode: difference;
      display: none;
    }
    
    #text-wrap { 
      min-width:0; 
      margin-top: -1.4rem; 
      width: 100%;
      box-sizing: border-box;
      overflow: hidden;
    }
    #unscramble { 
      white-space: pre-wrap; 
      font-size: 1.4rem;
      line-height: 1.8;
      word-wrap: break-word;
      overflow-wrap: break-word;
      height: 100%;
      overflow: hidden;
      width: 100%;
      box-sizing: border-box;
      max-width: 100%;
    }
    #prompt { 
      margin-top:1rem; 
      visibility:hidden; 
      white-space:pre-wrap; 
      line-height:1.6; 
      font-size: 1rem;
    }

    #nav { 
      display:flex; 
      justify-content:space-between; 
      align-items:center; 
      margin:3vh 0 1vh; 
      font-size:2rem;
      min-height: 5vh;
      position: relative;
    }
    #nav span { cursor:pointer; user-select:none; padding:0 1em; }
    #nav-msg { 
      flex-grow:1; 
      text-align:center; 
      font-size:1rem;
      min-height: 1.5rem;
      visibility: hidden;
    }
    #hud { 
      margin-top:1vh; 
      font-size:1rem;
      display:flex; 
      align-items:center; 
      gap:1rem; 
      opacity:.9; 
    }
    #hud .badge { 
      display:inline-block; 
      border:1px solid var(--accent); 
      padding:.2rem .5rem; 
      border-radius:999px; 
      font-weight:bold; 
      letter-spacing:.03em; 
      color: var(--accent);
      text-shadow: 0 0 2px var(--accent), 0 0 12px var(--accent);
    }
    #hud .controls { 
      display: none;
    }
    
    #page-counter {
      position: fixed;
      bottom: 2vh;
      right: 3vw;
      font-size: 0.8rem;
      opacity: 0.6;
      color: var(--accent);
      text-shadow: 0 0 2px var(--accent), 0 0 8px var(--accent);
      font-family: monospace;
      pointer-events: none;
      z-index: 1000;
    }
    
    /* Side mode: text on left, image on right */
    #text-wrap.side-mode {
      width: 60% !important;
      max-width: 60% !important;
      position: relative !important;
      z-index: 2 !important;
    }
    
    #text-wrap.side-mode #unscramble {
      width: 100% !important;
      max-width: 100% !important;
      overflow: visible !important;
      white-space: pre-wrap !important;
      word-wrap: break-word !important;
      overflow-wrap: break-word !important;
    }
  </style>
</head>
<body>
  <div id="page">
    <div id="text-wrap">
      <div id="unscramble"></div>
      <div id="prompt"></div>
    </div>
    
    <!-- Images will be added here dynamically -->
  </div>

  <div id="nav">
    <span id="nav-prev">&lt;</span>
    <span id="nav-msg"></span>
    <span id="nav-next">&gt;</span>
  </div>

  <div id="hud">
    <span class="controls">[1/2/3] color • [↑/↓] image mode • [B] background • [L] below • [S] side • [O] off • [Z/X/C] overlay</span>
  </div>

  <div id="page-counter">Page <span id="current-page">1</span></div>
  
  <!-- Custom cursor -->
  <div id="custom-cursor"></div>

  <script>
    /* ================== CONTENT ================== */
    const fullTextRaw = `



THE SIX BILLION DOLLAR MAN



A film by Eugene Jarecki







ASSANGE'S STORY IS THAT OF A RELENTLESS FIGHT AGAINST AN EMPIRE THAT WANTS JOURNALISTS TO FEAR TELLING THE TRUTH

FOR PEOPLE TO REMAIN IGNORANT TO HOW THE WORLD IS RUN







THIS DOCUMENTARY USES UNSEEN FOOTAGE OF JULIAN ASSANGE AND THE WIKILEAKS TEAM AS WELL AS EXCLUSIVE INTERVIEWS WITH THOSE WHO WERE THERE ON THE JOURNEY

TO SHOW YOU WHAT REALLY HAPPENED







You may think you know the story.

you don't.








Much of what has passed for "truth" in the mainstream narrative was shaped through a careful choreography of distortion, discrediting, and erasure. 





WikiLeaks, once a global lightning rod, has been buried beneath the churn of 24/7 news and state-sanctioned amnesia. But the mechanisms Assange exposed 

        > surveillance, secrecy, impunity 

haven't vanished. 







Beginning in 2006 with the ideals of the cypherpunk movement, WikiLeaks built a secure publishing platform that bypassed traditional media gatekeepers.





It published the infamous 

		> Collateral Murder video,

		> Afghan and Iraq War Logs, 

		> Cablegate diplomatic archives, 

transforming how the public understood war, diplomacy, and power. 







In the process, Assange became both symbol and target.

This film, shot over four years and during Assange's detention in H.M. Belmarsh prison, traces the collapse of his sanctuary, the turning of political tides in Ecuador, and the global machinery that moved to silence him. 







With the stroke of a pen and a $6 billion IMF deal, his asylum ended. What followed was

        > incarceration, 
        > isolation, 
        > and eventual release 
        through a plea deal under the Espionage Act 

a historic first for a publisher.







In 2010, WikiLeaks was financially blacklisted by 

		> Visa
		> Mastercard
		> PayPal 

Assange turned to cryptocurrency




		"Bitcoin is the real Occupy Wall Street," 
                				-Julian Assange



                        
Early BTC donations helped WikiLeaks survive.

The Cypherpunk roots of Bitcoin and WikiLeaks are the same: 

        > privacy, 
        > decentralisation, 
        > freedom.




        
AssangeDAO (2022) raised $53M in a week for Assange's legal defense.

The crypto world has already spoken. This film gives that voice a platform.





Our film challenges entrenched narratives. 

We have already met resistance in traditional media channels.

Corporate platforms benefit from a distracted audience and a discredited Assange.

We need decentralised support to bypass censorship and algorithmic throttling.







You know the architecture of silence. 

Help us break it.





What We're Asking:

> Initial crypto contribution to fund 
		distribution, 
		promotion and an 
		impact campaign.

> Public endorsement (if desired) to galvanise the broader crypto sphere.

> Strategic guidance to Bitcoin-aligned distribution tools.
		



Use of Funds:

> Academy screenings and crypto-native distribution 
        (NFT access passes, decentralised streaming)

> Legal and security support for contributors in high-risk zones

> Aggressive promotional push now that Assange is free and public attention is resurgent





Transparency guaranteed: 
 	      
      > funds held in multi-sig wallet 
      with real-time public ledger.





Why You?

Your voice has stood consistently for 

	> decentralisation, 
	> free speech, and 
	> Bitcoin as resistance. 

You understand that speech without infrastructure is performative. 





Assange's prosecution is a prosecution of infrastructure: 

  > Publishing, 
  > cryptography, 
  > financial independence.

Supporting this film continues the work you've always done.





The crypto community, the only network that kept Assange alive 
can now ensure he's not erased.
		




Let's finish what we started.
  
   
    
     
     
Contact:
[Producers' Names]
[Secure Email]
[Wallet Address (BTC/ETH)]








[VIDEO_LOADING]
`;

    /* ================== PREP ================== */
    const fullText = fullTextRaw.toUpperCase();
    const pages = fullText.split(/\n{4,}/);
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 .,\'"?!-—:;\n';

    // Image modes
    const IMG_OFF = 0;
    const IMG_BG = 1;
    const IMG_BELOW = 2;
    const IMG_SIDE = 3;
    
    const pageModes = new Array(pages.length).fill(IMG_BG); // Default to background mode for all pages
    
    // Set specific default modes for certain pages
    pageModes[17] = IMG_SIDE; // Page 18 (index 17) defaults to side mode
    pageModes[22] = IMG_SIDE; // Page 23 (index 22) defaults to side mode

    // DOM
    const pageEl = document.getElementById('page');
    const textWrap = document.getElementById('text-wrap');
    const el = document.getElementById('unscramble');
    const promptElem = document.getElementById('prompt');
    const navMsg = document.getElementById('nav-msg');
    const pageCounterEl = document.getElementById('current-page');

    let currentPage = 0;
    let isAnimating = false;
    let currentInterval = null;

    // Simple image function - check what photos actually exist
    function showImage(pageIndex) {
      // Hide all existing images first
      document.querySelectorAll('#page img').forEach(img => {
        img.className = '';
      });
      
      // Hide video if it exists
      const videoEl = document.getElementById('final-video');
      if (videoEl) {
        videoEl.style.display = 'none';
      }
      
      // Check if this is the final video page
      if (pageIndex === pages.length - 1) {
        showFinalVideo();
        return;
      }
      
      const pageNumber = pageIndex + 1;
      let imgEl = document.getElementById(`img-${pageNumber}`);
      
      // If no image exists for this page yet, try to create one
      if (!imgEl) {
        imgEl = createImageForPage(pageNumber);
      }
      
      // Show image if it exists and mode isn't off
      if (imgEl && pageModes[pageIndex] !== IMG_OFF) {
        const mode = pageModes[pageIndex];
        if (mode === IMG_BG) imgEl.className = 'show-bg';
        else if (mode === IMG_BELOW) imgEl.className = 'show-below';
        else if (mode === IMG_SIDE) imgEl.className = 'show-side';
      }
      
      // Adjust text container width based on current image mode
      adjustTextContainerWidth(pageModes[pageIndex]);
    }
    
    // Create image for a page number - tries multiple formats
    function createImageForPage(pageNumber) {
      const img = document.createElement('img');
      img.id = `img-${pageNumber}`;
      img.alt = `Page ${pageNumber} Image`;
      
      // Start invisible - only show when successfully loaded
      img.style.opacity = '0';
      img.style.transition = 'opacity 0.2s ease-in-out';
      
      // Add to page first (invisible)
      document.getElementById('page').appendChild(img);
      
      // Try multiple formats in order
      tryImageFormats(img, pageNumber, 0);
      
      // Only show image when it loads successfully
      img.addEventListener('load', () => {
        console.log(`Image loaded successfully for page ${pageNumber}`);
        img.style.opacity = '1';
        
        // Apply current overlay mode to new image
        applyOverlayToImage(img, currentOverlayMode);
      });
      
      return img;
    }
    
    // Adjust text container when side image is active
    function adjustTextForSideImage() {
      adjustTextContainerWidth(IMG_SIDE);
    }
    
    // Reset text container when image is turned off
    function resetTextContainer() {
      adjustTextContainerWidth(IMG_OFF);
    }
    
    // Adjust text container width based on image mode
    function adjustTextContainerWidth(imageMode) {
      const textWrap = document.getElementById('text-wrap');
      if (!textWrap) return;
      
      if (imageMode === IMG_SIDE) {
        // Side mode: text on left, image on right
        textWrap.style.setProperty('width', '60%', 'important');
        textWrap.style.setProperty('max-width', '60%', 'important');
        textWrap.style.setProperty('position', 'relative', 'important');
        textWrap.style.setProperty('z-index', '2', 'important');
        textWrap.classList.add('side-mode');
      } else {
        // All other modes: text uses full width
        textWrap.style.setProperty('width', '100%', 'important');
        textWrap.style.setProperty('max-width', '100%', 'important');
        textWrap.style.setProperty('position', '', 'important');
        textWrap.style.setProperty('z-index', '', 'important');
        textWrap.classList.remove('side-mode');
      }
    }
    
    // Show final video with loading bar
    function showFinalVideo() {
      // Hide text
      const textWrap = document.getElementById('text-wrap');
      if (textWrap) {
        textWrap.style.display = 'none';
      }
      
      // Create video element if it doesn't exist
      let videoEl = document.getElementById('final-video');
      if (!videoEl) {
        videoEl = document.createElement('video');
        videoEl.id = 'final-video';
        videoEl.controls = true;
        videoEl.autoplay = false;
        videoEl.muted = false;
        videoEl.style.cssText = `
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          max-width: 90%;
          max-height: 90%;
          z-index: 10;
          display: none;
        `;
        videoEl.src = 'video.mp4';
        document.getElementById('page').appendChild(videoEl);
        
        // Apply current overlay mode to video
        applyOverlayToVideo(videoEl, currentOverlayMode);
      }
      
      // Show loading bar first
      showLoadingBar(() => {
        // Hide loading bar and show video
        hideLoadingBar();
        videoEl.style.display = 'block';
        videoEl.play();
      });
    }
    
    // Show loading bar
    function showLoadingBar(onComplete) {
      // Get current color from the color system
      const currentColor = getComputedStyle(document.getElementById('unscramble')).color;
      
      const loadingContainer = document.createElement('div');
      loadingContainer.id = 'loading-container';
      loadingContainer.style.cssText = `
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        z-index: 20;
      `;
      
      const progressBar = document.createElement('div');
      progressBar.id = 'progress-bar';
      progressBar.style.cssText = `
        width: 300px;
        height: 20px;
        border: 2px solid ${currentColor};
        background: var(--bg);
        margin: 0 auto;
        position: relative;
        overflow: hidden;
      `;
      
      const progressFill = document.createElement('div');
      progressFill.id = 'progress-fill';
      progressFill.style.cssText = `
        height: 100%;
        background: ${currentColor};
        width: 0%;
        transition: width 0.1s ease;
        box-shadow: 0 0 10px ${currentColor};
      `;
      
      progressBar.appendChild(progressFill);
      loadingContainer.appendChild(progressBar);
      document.getElementById('page').appendChild(loadingContainer);
      
      // Animate progress bar
      let progress = 0;
      
      const interval = setInterval(() => {
        progress += Math.random() * 15 + 5; // Random progress increments
        if (progress > 100) progress = 100;
        
        progressFill.style.width = progress + '%';
        
        if (progress >= 100) {
          clearInterval(interval);
          setTimeout(onComplete, 500);
        }
      }, 100);
    }
    
    // Hide loading bar
    function hideLoadingBar() {
      const loadingContainer = document.getElementById('loading-container');
      if (loadingContainer) {
        loadingContainer.remove();
      }
    }
    
    // Try different image formats
    function tryImageFormats(img, pageNumber, formatIndex) {
      const formats = ['jpg', 'jpeg', 'webp', 'png', 'gif'];
      
      if (formatIndex >= formats.length) {
        // All formats failed, remove the image
        img.remove();
        return;
      }
      
      // Remove any existing error listeners
      img.removeEventListener('error', img.errorHandler);
      
      // Create new error handler for this format
      img.errorHandler = () => {
        console.log(`Format ${formats[formatIndex]} failed for page ${pageNumber}, trying next...`);
        // Try next format
        tryImageFormats(img, pageNumber, formatIndex + 1);
      };
      
      img.addEventListener('error', img.errorHandler);
      console.log(`Trying format ${formats[formatIndex]} for page ${pageNumber}`);
      img.src = `photos/photo${pageNumber}.${formats[formatIndex]}`;
    }

    /* ================== TEXT TRUNCATION ================== */
    function truncateTextToFit(element, text) {
      element.textContent = text;
      
      // Force text to fit by reducing font size if needed
      if (element.scrollHeight > element.clientHeight) {
        let fontSize = parseFloat(getComputedStyle(element).fontSize);
        
        // Keep reducing font size until text fits
        while (element.scrollHeight > element.clientHeight && fontSize > 0.8) {
          fontSize -= 0.1;
          element.style.fontSize = fontSize + 'rem';
        }
        
        // If still doesn't fit, truncate lines
        if (element.scrollHeight > element.clientHeight) {
          const lines = text.split('\n');
          const lineHeight = parseFloat(getComputedStyle(element).lineHeight);
          const maxLines = Math.floor(element.clientHeight / lineHeight);
          
          let truncatedLines = lines.slice(0, Math.max(1, maxLines - 1));
          if (truncatedLines.length < lines.length) {
            if (truncatedLines.length > 0) {
              truncatedLines[truncatedLines.length - 1] += '...';
            }
          }
          
          element.textContent = truncatedLines.join('\n');
        }
      }
    }

    /* ================== SCRAMBLE ================== */
    function scrambleFastChunks(element, text, onComplete) {
      if (currentInterval) {
        clearInterval(currentInterval);
        currentInterval = null;
      }
      
      let index = 0, chunkSize = 15, scrambled = text.split(''), len = text.length;
      for (let i=0;i<len;i++) scrambled[i] = /\s/.test(text[i]) ? text[i] : chars[Math.floor(Math.random()*chars.length)];
      isAnimating = true; promptElem.style.visibility='hidden'; navMsg.style.visibility='hidden';

      currentInterval = setInterval(() => {
        const display = scrambled.slice();
        for (let i=0;i<index;i++){
          let s=i*chunkSize, e=Math.min(s+chunkSize,len);
          for (let j=s;j<e;j++) display[j]=text[j];
        }
        for (let k=index*chunkSize;k<len;k++) display[k] = /\s/.test(text[k]) ? text[k] : chars[Math.floor(Math.random()*chars.length)];
        element.textContent = display.join('');
        index++;
        if ((index*chunkSize)>=len){
          clearInterval(currentInterval);
          currentInterval = null;
          truncateTextToFit(element, text);
          isAnimating=false;
          navMsg.textContent='PRESS SPACEBAR TO CONTINUE';
          navMsg.style.visibility='visible';
          onComplete && onComplete();
        }
      },80);
    }

    /* ================== PAGE RENDER ================== */
    function startPage(pageIndex){
      if (pageIndex >= pages.length) pageIndex = 0;
      if (pageIndex < 0) pageIndex = pages.length - 1;
      currentPage = pageIndex;
      
      pageCounterEl.textContent = pageIndex + 1;
      navMsg.style.visibility = 'hidden';
      
      // Show text for all pages except the last one
      if (pageIndex < pages.length - 1) {
        const textWrap = document.getElementById('text-wrap');
        if (textWrap) {
          textWrap.style.display = 'block';
        }
        
        el.textContent='';
        isAnimating = false;
        scrambleFastChunks(el, pages[pageIndex], () => {
          // Text displayed
        });
      }
      
      showImage(pageIndex);
    }

    /* ================== NAV ================== */
    let lastAdvance = 0;
    function throttle(){ const now=Date.now(); if (now-lastAdvance<300) return false; lastAdvance=now; return true; }
    function safeAdvance(){ if (!throttle()) return; startPage(currentPage+1); }
    function goBack(){ if (!throttle()) return; startPage(currentPage-1); }

    document.getElementById('nav-prev').addEventListener('pointerdown', goBack, {passive:true});
    document.getElementById('nav-next').addEventListener('pointerdown', safeAdvance, {passive:true});
    document.getElementById('nav-prev').addEventListener('touchstart', goBack, {passive:true});
    document.getElementById('nav-next').addEventListener('touchstart', safeAdvance, {passive:true});
    document.getElementById('nav-prev').addEventListener('click', goBack);
    document.getElementById('nav-next').addEventListener('click', safeAdvance);
    document.addEventListener('pointerdown', (e)=>{ if (e.target.id==='nav-prev'||e.target.id==='nav-next') return; safeAdvance(); }, {passive:true});
    document.addEventListener('touchstart', (e)=>{ if (e.target.id==='nav-prev'||e.target.id==='nav-next') return; safeAdvance(); }, {passive:true});
    document.addEventListener('click', (e)=>{ if (e.target.id==='nav-prev'||e.target.id==='nav-next') return; safeAdvance(); });

    window.addEventListener('keydown', (e) => {
      if (e.code==='Space'||e.code==='ArrowRight'){ e.preventDefault(); startPage(currentPage+1); }
      else if (e.code==='ArrowLeft'){ e.preventDefault(); startPage(currentPage-1); }

      const k = e.key;
      if (k==='ArrowUp'){ pageModes[currentPage]=(pageModes[currentPage]+1)%4; showImage(currentPage); }
      else if (k==='ArrowDown'){ pageModes[currentPage]=(pageModes[currentPage]-1+4)%4; showImage(currentPage); }
      else if (k==='b'||k==='B'){ pageModes[currentPage]=IMG_BG; showImage(currentPage); }
      else if (k==='l'||k==='L'){ pageModes[currentPage]=IMG_BELOW; showImage(currentPage); }
      else if (k==='s'||k==='S'){ pageModes[currentPage]=IMG_SIDE; showImage(currentPage); adjustTextForSideImage(); }
      else if (k==='o'||k==='O'){ pageModes[currentPage]=IMG_OFF; showImage(currentPage); resetTextContainer(); }
      else if (k==='z'||k==='Z'){ toggleGreenOverlay('full'); }
      else if (k==='x'||k==='X'){ toggleGreenOverlay('half'); }
      else if (k==='c'||k==='C'){ toggleGreenOverlay('off'); }
    });

    /* ================== COLOR/GLOW ================== */
    (function(){
      const navPrev = document.getElementById('nav-prev');
      const navNext = document.getElementById('nav-next');
      const terminals = [document.getElementById('unscramble'), document.getElementById('prompt'), document.getElementById('nav-msg'), navPrev, navNext, document.getElementById('page-counter')];
      let colorIndex=2; // Default to soft green (option 3)
      const colors=['#CCCCCC','#00FF00','#66FF66'];
      function apply(){
        terminals.forEach(el=>{ if(!el) return;
          el.style.color = colors[colorIndex];
          el.style.textShadow = `0 0 2px ${colors[colorIndex]}, 0 0 12px ${colors[colorIndex]}`; // Glow always on
        });
        
        // Update cursor color to match
        const customCursor = document.getElementById('custom-cursor');
        if (customCursor) {
          customCursor.style.background = colors[colorIndex];
          customCursor.style.boxShadow = `0 0 2px ${colors[colorIndex]}, 0 0 12px ${colors[colorIndex]}`;
        }
      }
      document.addEventListener('keydown', (e)=>{
        if (e.key==='1'||e.key==='2'||e.key==='3'){ colorIndex=parseInt(e.key,10)-1; apply(); }
      });
      apply();
    })();

    /* ================== INIT ================== */
    window.onload = () => {
      // Hide any images that fail to load
      document.querySelectorAll('#page img').forEach(img => {
        img.addEventListener('error', () => {
          img.style.display = 'none';
        });
      });
      
      // Custom cursor functionality
      const customCursor = document.getElementById('custom-cursor');
      
      document.addEventListener('mousemove', (e) => {
        customCursor.style.display = 'block';
        customCursor.style.left = e.clientX - 10 + 'px';
        customCursor.style.top = e.clientY - 10 + 'px';
      });
      
      document.addEventListener('mouseleave', () => {
        customCursor.style.display = 'none';
      });
      
      startPage(0);
    };
    
    // Global green overlay toggle function
    let currentOverlayMode = 'full'; // Track current overlay mode - default to full green
    
    function toggleGreenOverlay(mode) {
      currentOverlayMode = mode; // Store the current mode
      const images = document.querySelectorAll('#page img');
      images.forEach(img => {
        applyOverlayToImage(img, mode);
      });
      
      // Also apply to video if it exists
      const video = document.getElementById('final-video');
      if (video) {
        applyOverlayToVideo(video, mode);
      }
    }
    
    // Apply overlay to a specific image
    function applyOverlayToImage(img, mode) {
      if (mode === 'full') {
        img.style.filter = 'brightness(0.7) sepia(1) hue-rotate(60deg) saturate(1.5)';
      } else if (mode === 'half') {
        img.style.filter = 'brightness(0.7) sepia(0.5) hue-rotate(60deg) saturate(1.2)';
      } else if (mode === 'off') {
        img.style.filter = 'brightness(0.7)';
      }
    }
    
    // Apply overlay to a specific video
    function applyOverlayToVideo(video, mode) {
      if (mode === 'full') {
        video.style.filter = 'brightness(0.7) sepia(1) hue-rotate(60deg) saturate(1.5)';
      } else if (mode === 'half') {
        video.style.filter = 'brightness(0.7) sepia(0.5) hue-rotate(60deg) saturate(1.2)';
      } else if (mode === 'off') {
        video.style.filter = 'brightness(0.7)';
      }
    }
  </script>
</body>
</html>